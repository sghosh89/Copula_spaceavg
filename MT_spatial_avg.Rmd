---
title: "Asymmetric tail association affects community stability"
author: "Shyamolina Ghosh, other authors, Daniel Reuman"
date: "`r format(Sys.time(), '%d %B, %Y')`"
#date: "October 12, 2018"
geometry: "left=1 in,right=1 in,top=1 in,bottom=1 in"

output: 
  pdf_document:
    number_sections: no
    keep_tex: yes
    fig_caption: yes

header-includes:
      - \usepackage{xr} \externaldocument[SI-]{SI_spatial_avg}
      - \input{head_maintext.sty}

tables: True
link-citations: True
urlcolor : blue
indent : True
csl: ecology-letters.csl
bibliography: REF_CSS.bib
---

<!--***DAN: store alternative titles here, decide on one closer to the end
1) A complete description of synchrony and compensatory dynamics yields a better understanding of community stability
2) Asymmetric tail association, skewness and community stability
-->

```{r setup_Paper, echo=F}
knitr::opts_chunk$set(echo = TRUE, fig.pos = "H")
options(scipen = 1, digits = 5) #This option round all numbers appeared in the inline r code upto 5th digit
```

<!--Abstract-->
\newpage

\noindent \textbf{ABSTRACT} 

<!--keywords-->
\textbf{\textit{Keywords:}} Synchrony, tail-association, grassland, community variability, skewness


\newpage

# Introduction\label{Intro}
<!--Q1 : Do syncronous/ compensatory pop. dynamics in communities commonly show asymmetric tail association?, 
Q2: If so, what are the consequences of these patterns for the stability of aggregated community properties?-->

<!--
NOTE: I need to rewrite the intro:
1. Don't say anything about copula (keep it for suppmat), but introduce the concept of tail association (see ERC paper)
2. Motivate Q2 with aphid/plankton paper
3. present logically how asymmetric tail association should influence skewness - can be considered as a new measure of community stability. Also states may be it's not significant on individual interaction level but could be significant on aggregate level.
-->


<!--grassland and earlier work : Here I deliberately exclude the ref. for environmental variable effect on species-->
Understanding the mechanisms behind spatial and temporal 
dynamics has been a long-standing focus in community ecology [@gibson2009; @turner1989].
Interspecies interaction in a grassland 
community could be advantageous or
disadvantageous to either or both species involved, 
which led to mutualism or competition
as the case might be. A community is thought to be resilient towards environmental extremes
through time when members of that community show variable and/ or asynchronous fluctuations. But if most of 
the species in a community vary synchronously through time then in a "bad"
year (e.g. extreme drought) with limiting resource could wipe out the whole community.
Thus identifying patterns of species fluctuations over time and in relation to 
each other is essential to understand community-stability. Most of the prior studies 
used, in general, the correlation or regression based approach to 
understand variability of a species response with other
species within a community (or with environmental variables) to establish causal
relationship. But they are inadequate to explain the joint distribution structure 
of multiple species response within a community.

<!--Limitation of usual approach and introduction of copula?-->
Common correlation measures, i. e., Pearson's correlation used in earlier studies, is based 
on the notions of linearity, normality and mean which are not appropriate when dealing 
with extreme events or for non-normal distributions which occur commonly in ecological
datasets [our BIVAN paper]. Though rank-based non-parametric dependence measures, Spearman's 
$\rho$ and Kendall's $\tau$, do not assume linearity and normality, but they do not attribute 
sufficient weight to the extreme values and the distribution tail. Thus a better approach to model
multivariate dependence structure is necessary. Concept of a copula is a widely used 
statistical tool in other fields to model dependence between 
multiple variables [@joe2014_dependence; @nelsen2006_copula; 
@sklar1959_theorem; @burnham2003_modelselection]. A "copula" can separate the 
information contained in a joint distribution of bivariate random variables 
into two distinct parts: the information contained in the marginal 
distributions (which says nothing about the dependence between the 
variables), and the remaining information (which is solely
about the dependence between the variables). From a data perspective, we can construct 
a bivariate copula from a set of two variables
$\{ x_i, y_i\}, i = 1, 2, \ldots , n$ after some ranking procedure is applied so that 
their marginal distributions become uniform. If $\{ \bar{u_i}, \bar{v_i}\}$ are the
corresponding ranks of $\{ x_i, y_i\}$, then the "normalized rank" 
$\{ u_i, v_i\} = \{ \bar{u_i}, \bar{v_i}\} / (n+1)$
reveals the associated dependence in the bivariate copula when plotted in a unit square. 
Through suitable choice from a wide varity of families and parameters, one can control 
this dependence structure of a bivariate copula which shows over which parts of the 
distributions the variables are more strongly associated. This information
is implied in their degree of "tail-dependence" which can be viewed as stronger 
association between two random variables in their extreme values. If smaller values of 
two positively associated variables are more strongly correlated than are larger values, 
the variables are said to have stronger lower- or left-tail dependence than right- or 
upper-tail dependence (Fig. \ref{fig_pedag_taildep}A); and vice versa if higher values are more strongly
associated than smaller ones (Fig. \ref{fig_pedag_taildep}B). A copula might have symmetric 
(with zero tail-dependence in both tail) or asymmetric (finite tail-dependence in either
or both tail) feature depending on its family and parameters [@nelsen2006_copula].

<!--\begin{tcolorbox}[width=\columnwidth,colback={blue!20},arc=0mm,colframe=blue!50!black,coltext=blue!50!black]
Significance
Write significance here.
\end{tcolorbox}-->  

<!--why copula (and tail-dep.) is important in ecology, specially on grassland? : 
1) direction of competetion
2) leibig's law
3) global climate change : ongoing invasion and sp. extinction : pollinators?
-->
The benefit of using copula with its unique tail-dependence feature is that it can be applied
to model synchronous (or compensatory) response between two or more ecological variables. 
Spatial synchrony [@liebhold2004; @walter2017; @sheppard2016] between 
metapopulations, is recently investigated using copula (BIVAN paper),
but there has been no report using copula approach in explaining 
multi-species dynamics within a commulity.
Here we will summarize how copula could be useful in ecology, specially in a grassland 
ecosystem perspective. First, in case of compensatory dynamics between any two species 
over years, tail dependence
measurement using a bivariate copula not only shows species are negatively correlated but 
in addition could indicate which one is superior competitor between them. Secondly, earlier 
studies showed the importance of limiting resources (soil nutrients, N, P)
(Leibig's law) in the grassland productivity [@reynolds2003; @de2004; @john2007; @fay2015]. 
Therefore, a community showing overall
lower tail-dependence throughout years could suggest that the species-abundance on average
was limited as a particular resource became rare in that field and experimental addition of 
soil-fertilizer could improve their productivity after years. As multiple species in a
grassland community could show limited growth
with respect to multiple nutrients and to different extent, therefore adding nutrient 
may increase the net primary productivity but could also reduce niche-dimensionality 
and increase compositional turnover [@harpole2016]. Using pairwise copula approach for
modelling a multivariate dependence structure offers more insight to understand
individual species' response towards their drivers separately. Third, long-term and short-term
experiments established that change in global climate induced changes in species-composition 
in a grassland community 
[@cowles2016; @garcia2018; @harrison2015; @eisenhauer2013; @zavaleta2003]. 
For example, abundant growth of invasive species in their "favorable" scope on
space or time-scale [@white2001; @thomason2017] could suppress
and even lead to extinction of their weak competitors which are natives in a community.
This scenario could also evoke a potential threat for the pollinator 
community (e.g. butterfly) due to their habitat loss [@mclaughlin2002; @thomas2004].
Monitoring tail-dependence of species-above ground biomass of 
a plant with respect to any of biotic and/ or abiotic factors could be beneficial
against this threat of biodiversity loss in a grassland eco-system. 

<!--community variability in view of skewness change?-->
Overall asymmetric tail-dependence (either lower or upper) bears a major implication
in estimating the pattern of community-variability and thus in turn stability of its 
compositional balance. A major lower (or upper) tail dependence in community structure arises 
due to simultaneous rare (or abundant) occurrence of the species and thus the "spikiness" of 
their individual time series become more or less synchronous in their low (or high) values.
Lower tail dependence in the time series of individual species biomass makes total biomass 
distribution of a community through years less skewed (see Fig. \ref{fig_pedag_skewness}A, synchronous 
fluctuations in low values) whereas upper tail dependence leads to more skewed 
(see Fig. \ref{fig_pedag_skewness}B, synchronous 
fluctuations in high values) distribution of total productivity through years
as compared to a community having no major asymmetric tail-dependence feature. 
Significantly lower skewness (arising from lower 
tail dependence) not only affects net primary productivity of a community 
but could also make some native species disappear from the system. The second scenario is 
that the overall skewness could change abruptly due to some "episodic" species, which occur 
in plenty in the community all of a sudden. Thus in a favorable scope of year, these episodic species
could take over the existing community and change the compositional balance in subsequent stages. 
Tracking skewness of a community over a period of years could serve
beneficial to better strategize conservation and management of native species. 
In terms of stability assessment, a community could be considered as less stable 
if the absolute value of skewness of total biomass time series is relatively high 
which, we argue, is coming from the stronger correlation of individual species-biomass
in their extreme values. <!-- am I right for this last sentence?-->

<!--Pedagogical figure for copula with asym. taildep.-->
\begin{figure}[!h]
\textbf{ \hspace{2 cm} (A) \hspace{3.7 cm} (B)}
\vspace{-0.8 cm}
\begin{center}
\includegraphics[width=\columnwidth]{./Results/pedagog_figs/LTUT_rho_0.8.pdf}
\caption{ Pedagogical figure showing asymmetric tail dependence between $500$ observations of 
two positively correlated variables $(u,v)$ with same Spearman correlation $\rho = 0.8$;
$(A)$ lower or left tail dependence indicates stronger association in extreme lower values, whereas $(B)$ upper 
or right tail dependence indicates stronger association in their extreme higher values.\label{fig_pedag_taildep}}
\end{center}
\end{figure}

<!--Pedagogical figure for skewness & taildep.-->
\begin{figure}[!h]
\begin{center}
\textbf{ \hspace{-6 cm} (A)} \\
\includegraphics[width=\columnwidth]{./Results/pedagog_figs/extremeLT_tot_ts.pdf}\\
\textbf{ \hspace{-6 cm} (B)} \\
\includegraphics[width=\columnwidth]{./Results/pedagog_figs/extremeRT_tot_ts.pdf}
\caption{Pedagogical figure showing how skewness of total biomass distribution of a community 
is affected by extreme asymmetric tail-dependence (Appendix \ref{SI-extreme_taildep_mat}) in individual 
species biomass-distribution throughout years. Major lower tail dependence in 
a community makes its total biomass more negatively skewed $(A)$, whereas
major upper tail dependence in a community makes 
its total biomass more positively skewed $(B)$, compared to a
community which is generated via a resampling method (Appendix \ref{SI-skew_ncsurrog})
to have no tail-dependence but preserving pairwise Spearman correlation
between any two species' time series.\label{fig_pedag_skewness}}
\end{center}
\end{figure}

<!--Why choose jasper ridge and hays as study system?-->
In this paper, we will preach for the potential of using "copula" approach to analyze
species' response within a community in understanding variation in species-richness
over a temporal scale. We consider two grassland ecosystems for our study. 

<!--write about 2nd dataset : KNZ-->






Both datasets (Appendix \ref{SI-Data}) have been served as experimental model system to 
study ecological hypothesis since long and proved to be effective
in decision making from conservation and management perspective. 

<!-- what is our objective?-->
 Our objective is to examine the 
synchronous (for positively correlated variables)
or compensatory (for negatively correlated variables) dynamics, if any, in 
the serpentine grassland of JRBP and prairie of Hays in Kansas 
using "tail-dependence" feature of copula.
Implementing a model selection approach (Appendix \ref{SI-model_sel}) as well as nonparametric 
analysis (Appendix \ref{SI-nonparam}), we 
try to find is there any overall major asymmetric tail-dependence in those grassland community and
if there is, then what could we interpret about inter-species response from this
asymmetric tail-dependence? We also suggest an alternative measure of 
community variability (henceforth stability) in terms of quantifying skewness of 
total biomass distribution over years using those two datasets.

# Theory and methods \label{Methods} 

<!--NOTE: if you can, just separate theory and methods section.


1. For Q1:
      - introduce partial Spearman correlation to measure tail asymmetry corl - coru (need schematic diagram)
      - corl - coru in community context, count on L, U (+ve correlation only)
      - binomial and significance testing
2. For Q2:
      - skewness ratio in analogy with variance ratio
      - separate the contributions from tail association and usual correlation (Pearson) 
      - need schematic diagram to show the relation (this diagram will again help to interpret results for Q2)
-->


# Results\label{Results}

<!--
For Q1: plot with hays and knz corl-coru (2 panels a,b)
For Q2: multipanel plot with figs:
            - same schematic diagram as of method section but now with corresponding numerical value
            - histogram for hays and knz
-->


As mentioned earlier, we here present the results from the study carried out with the
spatio-temporal basal cover data (for 51 quadrats over 41 years, 1932-1972)
of mixed grass priarie near Hays, KS (for details see
Appendix \ref{SI-Data}). We here analyzed
our findings from a model-selection based 
copula approach, but we also verified the overall finding using
alternative nonparametric analysis (Appendix \ref{SI-compare_methods}).

<!--Results from Hays-->
We carried out the tail-dependence analysis with the basal cover time series of
20 most common species and the rest of the species data aggregated into single pseudo-species
found in prairie of Hays, Kansas (Table \ref{SI-tab_spinfo_hays}). We
found lower tail-dependence (considering positively correlation in
counting lower and upper tail dependent pairwise copula) were dominant, overall, in 
the community (Fig. \ref{fig_LTmUT_spaceavg_hays}). We will discuss here few instances 
of interspecific interactions which 
we found interesting. Some deep rooted grasses (e.g. sp2 : ANGE, 
sp11 : PAVI2 and sp13 : PSTE5) showed upper tail dependence with synchronous abundance
with each other (Fig. \ref{fig_LTmUT_spaceavg_hays}) 
whereas they were not as strongly 
correlated in other years 
(see Fig. \ref{SI-fig_hays_spaceavg_dryseasoned_grass_UTdep}). 
On the other hand, when \textit{Schizachyrium scoparium} (sp14) was abundant throughout 
the plots for certain years, it appeared to be a stronger competitor 
(Fig \ref{SI-fig_hays_spaceavg_SCSC_interactions}) suppressing growth of 
other drought-tolerant grasses (e. g. \textit{Bouteloua gracilis} (sp5), 
\textit{Paronychia jamesii} (sp12), 
\textit{Sporobolus asper} (sp17) , \textit{Sporobolus cryptandrus} (sp18)) which
were found to be synchronously rare and lower tail-dependent within themselves (positively 
correlated red cells in Fig. \ref{fig_LTmUT_spaceavg_hays}).

<!--Results from skewness as a measure of community variability-->

<!--Need to modify the following results-->

<!--Major lower tail dependence than upper, as observed in interspecific interactions 
in both grassland communities (Figs. \ref{fig_LTmUT_spaceavg_jrg}-\ref{fig_LTmUT_spaceavg_hays},
$nL>NU$) could play a significant contributors in predicting their stabilities. Via skewness 
measurement of total productivity through out the study period, one can assess an alternate measure 
of community-variability. Following the idea as we introduced in the earlier section, 
for each of the 36 years (1983-2018), we computed total percent cover
(averaged throughout the plots) of the species in Jasper Ridge.
We measured skewness of this aggregated percent cover time-series and compared against 
skewnesses of $10000$ "Normal" surrogate time-series which were meant to have no tail-dependence
but same pairwise Spearman correlation between species (for details see Appendix \ref{SI-skew_ncsurrog}).
We repeated this procedure for five different combination of species (see Fig. \ref{SI-fig_jrg_spaceavg_skewness})
in JRBP: considering total percent cover timeseries from (i) only 23 common sp., (ii) 23 common sp. and 
rest aggregated into one pseudo sp., 
(iii) 34 common and intermediate sp., (iv) 34 common and intermediate sp. along with the rest aggregated into 
one pseudo sp., (v) all sp. including the rare ones (for classification of species 
categories see Appendix \ref{SI-Data}, Fig. \ref{SI-fig_spaceavg_timeseries}). As a community with major lower tail dependence, JRBP was 
expected to show significantly lower skewness than symmetric "Normal" surrogates. We found the expected results with 
all five combinations. Similar results with significant lower skewness
because of dominant lower tail-dependence in the comminity was observed with Hays datasets (Fig. 
\ref{SI-fig_hays_spaceavg_skewness}). As skewness is related to the "spikiness" of the time-series
concerned, significantly lower skewness than its "Normal" analog scale means the community could have 
a potential threat for some of its native species which could crash simultaneously below a threshold. -->

\begin{figure*}[!h]
\begin{center}
\includegraphics[width=9cm]{./Results/hays_results/LTmUT_hays_spaceavg.pdf} 
\caption{Model averaged lower tail - upper tail dependence matrix for 20 most common plant species along with 
other species merged into a pseudo species (Table \ref{SI-tab_spinfo_hays}) found in Hays priarie, 
details were discussed in \nameref{Results}. 
nL and nU are the count of cells (considered for positive correlation only)
with positive and negative tail-dependence difference 
values for 21$\times$21 matrix; 
nL$>$nU (majority of red cells) indicates major lower tail dependence
in sp-sp interaction matrix.
Yellow cells indicate independent relationship. Initially negatively correlated cells contain a number 
indicating the id of the species (in column) that was taken reversed when constructing bivariate
copula to make positively correlated (for details see Appendix \ref{SI-model_sel}).\label{fig_LTmUT_spaceavg_hays}}
\end{center}
\end{figure*}

\begin{figure*}[!h]
\begin{center}
\includegraphics[width=10.8cm]{./Results/knz_results/LTmUT_knz_spaceavg.pdf} 
\caption{Similar model averaged lower tail - upper tail dependence matrix as of Fig. \ref{fig_LTmUT_spaceavg_hays}
but for 27 most common plant species (Table \ref{SI-tab_spinfo_hays}) found in Konza priarie.\label{fig_LTmUT_spaceavg_knz}}
\end{center}
\end{figure*}




# Discussion



### \textbf{For Data and Methods, see Appendix \ref{SI-Data} and \ref{SI-Methods} in Supporting material, respectively.}




\clearpage
\setlength{\parindent}{-0.2in}
\setlength{\leftskip}{0.2in}
\setlength{\parskip}{1pt}
\noindent









